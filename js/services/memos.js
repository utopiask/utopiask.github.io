utils.jq(()=>{$(function(){const o=document.getElementsByClassName("ds-memos");for(var n=0;n<o.length;n++){const t=o[n],r=t.getAttribute("api");if(r==null)continue;const g=t.getAttribute("avatar")||def.avatar,u=t.getAttribute("limit"),h=r.replace(/https:\/\/(.*?)\/(.*)/i,"$1");utils.request(t,r,function(m){var a=[];const l=t.getAttribute("user");l&&l.length>0&&(a=l.split(","));var f=[];const c=t.getAttribute("hide");c&&c.length>0&&(f=c.split(",")),m.forEach((s,v)=>{if(u&&v>=u||s.user&&s.user.login&&a.length>0&&!a.includes(s.user.login))return;let p=new Date(s.createdTs*1e3);var e='<div class="timenode" index="'+v+'">';e+='<div class="header">',!a.length&&!f.includes("user")&&(e+='<div class="user-info">',g.length>0&&(e+=`<img src="${g}">`),e+="<span>"+s.creatorName+"</span>",e+="</div>"),e+="<span>"+p.toLocaleString()+"</span>",e+="</div>",e+='<div class="body">',e+=marked.parse(s.content||"");var d=[];for(let i of s.resourceList)i.type?.includes("image/")&&d.push(i);if(d.length>0){e+='<div class="tag-plugin image">';for(let i of d)i.externalLink?.length>0?e+=`<div class="image-bg"><img src="${i.externalLink}" data-fancybox="memos"></div>`:e+=`<div class="image-bg"><img src="https://${h}/o/r/${i.id}" data-fancybox="memos"></div>`;e+="</div>"}e+="</div>",e+="</div>",$(t).append(e)})})}})});
